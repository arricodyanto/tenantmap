{"ast":null,"code":"'use strict';\n\n/**\n * Allows to drag and zoom svg elements\n */\nvar wheel = require('wheel');\nvar animate = require('amator');\nvar eventify = require('ngraph.events');\nvar kinetic = require('./lib/kinetic.js');\nvar createTextSelectionInterceptor = require('./lib/createTextSelectionInterceptor.js');\nvar domTextSelectionInterceptor = createTextSelectionInterceptor();\nvar fakeTextSelectorInterceptor = createTextSelectionInterceptor(true);\nvar Transform = require('./lib/transform.js');\nvar makeSvgController = require('./lib/svgController.js');\nvar makeDomController = require('./lib/domController.js');\nvar defaultZoomSpeed = 1;\nvar defaultDoubleTapZoomSpeed = 1.75;\nvar doubleTapSpeedInMS = 300;\nvar clickEventTimeInMS = 200;\nmodule.exports = createPanZoom;\n\n/**\n * Creates a new instance of panzoom, so that an object can be panned and zoomed\n *\n * @param {DOMElement} domElement where panzoom should be attached.\n * @param {Object} options that configure behavior.\n */\nfunction createPanZoom(domElement, options) {\n  options = options || {};\n  var panController = options.controller;\n  if (!panController) {\n    if (makeSvgController.canAttach(domElement)) {\n      panController = makeSvgController(domElement, options);\n    } else if (makeDomController.canAttach(domElement)) {\n      panController = makeDomController(domElement, options);\n    }\n  }\n  if (!panController) {\n    throw new Error('Cannot create panzoom for the current type of dom element');\n  }\n  var owner = panController.getOwner();\n  // just to avoid GC pressure, every time we do intermediate transform\n  // we return this object. For internal use only. Never give it back to the consumer of this library\n  var storedCTMResult = {\n    x: 0,\n    y: 0\n  };\n  var isDirty = false;\n  var transform = new Transform();\n  if (panController.initTransform) {\n    panController.initTransform(transform);\n  }\n  var filterKey = typeof options.filterKey === 'function' ? options.filterKey : noop;\n  // TODO: likely need to unite pinchSpeed with zoomSpeed\n  var pinchSpeed = typeof options.pinchSpeed === 'number' ? options.pinchSpeed : 1;\n  var bounds = options.bounds;\n  var maxZoom = typeof options.maxZoom === 'number' ? options.maxZoom : Number.POSITIVE_INFINITY;\n  var minZoom = typeof options.minZoom === 'number' ? options.minZoom : 0;\n  var boundsPadding = typeof options.boundsPadding === 'number' ? options.boundsPadding : 0.05;\n  var zoomDoubleClickSpeed = typeof options.zoomDoubleClickSpeed === 'number' ? options.zoomDoubleClickSpeed : defaultDoubleTapZoomSpeed;\n  var beforeWheel = options.beforeWheel || noop;\n  var beforeMouseDown = options.beforeMouseDown || noop;\n  var speed = typeof options.zoomSpeed === 'number' ? options.zoomSpeed : defaultZoomSpeed;\n  var transformOrigin = parseTransformOrigin(options.transformOrigin);\n  var textSelection = options.enableTextSelection ? fakeTextSelectorInterceptor : domTextSelectionInterceptor;\n  validateBounds(bounds);\n  if (options.autocenter) {\n    autocenter();\n  }\n  var frameAnimation;\n  var lastTouchEndTime = 0;\n  var lastTouchStartTime = 0;\n  var pendingClickEventTimeout = 0;\n  var lastMouseDownedEvent = null;\n  var lastMouseDownTime = new Date();\n  var lastSingleFingerOffset;\n  var touchInProgress = false;\n\n  // We only need to fire panstart when actual move happens\n  var panstartFired = false;\n\n  // cache mouse coordinates here\n  var mouseX;\n  var mouseY;\n\n  // Where the first click has happened, so that we can differentiate\n  // between pan and click\n  var clickX;\n  var clickY;\n  var pinchZoomLength;\n  var smoothScroll;\n  if ('smoothScroll' in options && !options.smoothScroll) {\n    // If user explicitly asked us not to use smooth scrolling, we obey\n    smoothScroll = rigidScroll();\n  } else {\n    // otherwise we use forward smoothScroll settings to kinetic API\n    // which makes scroll smoothing.\n    smoothScroll = kinetic(getPoint, scroll, options.smoothScroll);\n  }\n  var moveByAnimation;\n  var zoomToAnimation;\n  var multiTouch;\n  var paused = false;\n  listenForEvents();\n  var api = {\n    dispose: dispose,\n    moveBy: internalMoveBy,\n    moveTo: moveTo,\n    smoothMoveTo: smoothMoveTo,\n    centerOn: centerOn,\n    zoomTo: publicZoomTo,\n    zoomAbs: zoomAbs,\n    smoothZoom: smoothZoom,\n    smoothZoomAbs: smoothZoomAbs,\n    showRectangle: showRectangle,\n    pause: pause,\n    resume: resume,\n    isPaused: isPaused,\n    getTransform: getTransformModel,\n    getMinZoom: getMinZoom,\n    setMinZoom: setMinZoom,\n    getMaxZoom: getMaxZoom,\n    setMaxZoom: setMaxZoom,\n    getTransformOrigin: getTransformOrigin,\n    setTransformOrigin: setTransformOrigin,\n    getZoomSpeed: getZoomSpeed,\n    setZoomSpeed: setZoomSpeed\n  };\n  eventify(api);\n  var initialX = typeof options.initialX === 'number' ? options.initialX : transform.x;\n  var initialY = typeof options.initialY === 'number' ? options.initialY : transform.y;\n  var initialZoom = typeof options.initialZoom === 'number' ? options.initialZoom : transform.scale;\n  if (initialX != transform.x || initialY != transform.y || initialZoom != transform.scale) {\n    zoomAbs(initialX, initialY, initialZoom);\n  }\n  return api;\n  function pause() {\n    releaseEvents();\n    paused = true;\n  }\n  function resume() {\n    if (paused) {\n      listenForEvents();\n      paused = false;\n    }\n  }\n  function isPaused() {\n    return paused;\n  }\n  function showRectangle(rect) {\n    // TODO: this duplicates autocenter. I think autocenter should go.\n    var clientRect = owner.getBoundingClientRect();\n    var size = transformToScreen(clientRect.width, clientRect.height);\n    var rectWidth = rect.right - rect.left;\n    var rectHeight = rect.bottom - rect.top;\n    if (!Number.isFinite(rectWidth) || !Number.isFinite(rectHeight)) {\n      throw new Error('Invalid rectangle');\n    }\n    var dw = size.x / rectWidth;\n    var dh = size.y / rectHeight;\n    var scale = Math.min(dw, dh);\n    transform.x = -(rect.left + rectWidth / 2) * scale + size.x / 2;\n    transform.y = -(rect.top + rectHeight / 2) * scale + size.y / 2;\n    transform.scale = scale;\n  }\n  function transformToScreen(x, y) {\n    if (panController.getScreenCTM) {\n      var parentCTM = panController.getScreenCTM();\n      var parentScaleX = parentCTM.a;\n      var parentScaleY = parentCTM.d;\n      var parentOffsetX = parentCTM.e;\n      var parentOffsetY = parentCTM.f;\n      storedCTMResult.x = x * parentScaleX - parentOffsetX;\n      storedCTMResult.y = y * parentScaleY - parentOffsetY;\n    } else {\n      storedCTMResult.x = x;\n      storedCTMResult.y = y;\n    }\n    return storedCTMResult;\n  }\n  function autocenter() {\n    var w; // width of the parent\n    var h; // height of the parent\n    var left = 0;\n    var top = 0;\n    var sceneBoundingBox = getBoundingBox();\n    if (sceneBoundingBox) {\n      // If we have bounding box - use it.\n      left = sceneBoundingBox.left;\n      top = sceneBoundingBox.top;\n      w = sceneBoundingBox.right - sceneBoundingBox.left;\n      h = sceneBoundingBox.bottom - sceneBoundingBox.top;\n    } else {\n      // otherwise just use whatever space we have\n      var ownerRect = owner.getBoundingClientRect();\n      w = ownerRect.width;\n      h = ownerRect.height;\n    }\n    var bbox = panController.getBBox();\n    if (bbox.width === 0 || bbox.height === 0) {\n      // we probably do not have any elements in the SVG\n      // just bail out;\n      return;\n    }\n    var dh = h / bbox.height;\n    var dw = w / bbox.width;\n    var scale = Math.min(dw, dh);\n    transform.x = -(bbox.left + bbox.width / 2) * scale + w / 2 + left;\n    transform.y = -(bbox.top + bbox.height / 2) * scale + h / 2 + top;\n    transform.scale = scale;\n  }\n  function getTransformModel() {\n    // TODO: should this be read only?\n    return transform;\n  }\n  function getMinZoom() {\n    return minZoom;\n  }\n  function setMinZoom(newMinZoom) {\n    minZoom = newMinZoom;\n  }\n  function getMaxZoom() {\n    return maxZoom;\n  }\n  function setMaxZoom(newMaxZoom) {\n    maxZoom = newMaxZoom;\n  }\n  function getTransformOrigin() {\n    return transformOrigin;\n  }\n  function setTransformOrigin(newTransformOrigin) {\n    transformOrigin = parseTransformOrigin(newTransformOrigin);\n  }\n  function getZoomSpeed() {\n    return speed;\n  }\n  function setZoomSpeed(newSpeed) {\n    if (!Number.isFinite(newSpeed)) {\n      throw new Error('Zoom speed should be a number');\n    }\n    speed = newSpeed;\n  }\n  function getPoint() {\n    return {\n      x: transform.x,\n      y: transform.y\n    };\n  }\n  function moveTo(x, y) {\n    transform.x = x;\n    transform.y = y;\n    keepTransformInsideBounds();\n    triggerEvent('pan');\n    makeDirty();\n  }\n  function moveBy(dx, dy) {\n    moveTo(transform.x + dx, transform.y + dy);\n  }\n  function keepTransformInsideBounds() {\n    var boundingBox = getBoundingBox();\n    if (!boundingBox) return;\n    var adjusted = false;\n    var clientRect = getClientRect();\n    var diff = boundingBox.left - clientRect.right;\n    if (diff > 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n    // check the other side:\n    diff = boundingBox.right - clientRect.left;\n    if (diff < 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n\n    // y axis:\n    diff = boundingBox.top - clientRect.bottom;\n    if (diff > 0) {\n      // we adjust transform, so that it matches exactly our bounding box:\n      // transform.y = boundingBox.top - (boundingBox.height + boundingBox.y) * transform.scale =>\n      // transform.y = boundingBox.top - (clientRect.bottom - transform.y) =>\n      // transform.y = diff + transform.y =>\n      transform.y += diff;\n      adjusted = true;\n    }\n    diff = boundingBox.bottom - clientRect.top;\n    if (diff < 0) {\n      transform.y += diff;\n      adjusted = true;\n    }\n    return adjusted;\n  }\n\n  /**\n   * Returns bounding box that should be used to restrict scene movement.\n   */\n  function getBoundingBox() {\n    if (!bounds) return; // client does not want to restrict movement\n\n    if (typeof bounds === 'boolean') {\n      // for boolean type we use parent container bounds\n      var ownerRect = owner.getBoundingClientRect();\n      var sceneWidth = ownerRect.width;\n      var sceneHeight = ownerRect.height;\n      return {\n        left: sceneWidth * boundsPadding,\n        top: sceneHeight * boundsPadding,\n        right: sceneWidth * (1 - boundsPadding),\n        bottom: sceneHeight * (1 - boundsPadding)\n      };\n    }\n    return bounds;\n  }\n  function getClientRect() {\n    var bbox = panController.getBBox();\n    var leftTop = client(bbox.left, bbox.top);\n    return {\n      left: leftTop.x,\n      top: leftTop.y,\n      right: bbox.width * transform.scale + leftTop.x,\n      bottom: bbox.height * transform.scale + leftTop.y\n    };\n  }\n  function client(x, y) {\n    return {\n      x: x * transform.scale + transform.x,\n      y: y * transform.scale + transform.y\n    };\n  }\n  function makeDirty() {\n    isDirty = true;\n    frameAnimation = window.requestAnimationFrame(frame);\n  }\n  function zoomByRatio(clientX, clientY, ratio) {\n    if (isNaN(clientX) || isNaN(clientY) || isNaN(ratio)) {\n      throw new Error('zoom requires valid numbers');\n    }\n    var newScale = transform.scale * ratio;\n    if (newScale < minZoom) {\n      if (transform.scale === minZoom) return;\n      ratio = minZoom / transform.scale;\n    }\n    if (newScale > maxZoom) {\n      if (transform.scale === maxZoom) return;\n      ratio = maxZoom / transform.scale;\n    }\n    var size = transformToScreen(clientX, clientY);\n    transform.x = size.x - ratio * (size.x - transform.x);\n    transform.y = size.y - ratio * (size.y - transform.y);\n\n    // TODO: https://github.com/anvaka/panzoom/issues/112\n    if (bounds && boundsPadding === 1 && minZoom === 1) {\n      transform.scale *= ratio;\n      keepTransformInsideBounds();\n    } else {\n      var transformAdjusted = keepTransformInsideBounds();\n      if (!transformAdjusted) transform.scale *= ratio;\n    }\n    triggerEvent('zoom');\n    makeDirty();\n  }\n  function zoomAbs(clientX, clientY, zoomLevel) {\n    var ratio = zoomLevel / transform.scale;\n    zoomByRatio(clientX, clientY, ratio);\n  }\n  function centerOn(ui) {\n    var parent = ui.ownerSVGElement;\n    if (!parent) throw new Error('ui element is required to be within the scene');\n\n    // TODO: should i use controller's screen CTM?\n    var clientRect = ui.getBoundingClientRect();\n    var cx = clientRect.left + clientRect.width / 2;\n    var cy = clientRect.top + clientRect.height / 2;\n    var container = parent.getBoundingClientRect();\n    var dx = container.width / 2 - cx;\n    var dy = container.height / 2 - cy;\n    internalMoveBy(dx, dy, true);\n  }\n  function smoothMoveTo(x, y) {\n    internalMoveBy(x - transform.x, y - transform.y, true);\n  }\n  function internalMoveBy(dx, dy, smooth) {\n    if (!smooth) {\n      return moveBy(dx, dy);\n    }\n    if (moveByAnimation) moveByAnimation.cancel();\n    var from = {\n      x: 0,\n      y: 0\n    };\n    var to = {\n      x: dx,\n      y: dy\n    };\n    var lastX = 0;\n    var lastY = 0;\n    moveByAnimation = animate(from, to, {\n      step: function (v) {\n        moveBy(v.x - lastX, v.y - lastY);\n        lastX = v.x;\n        lastY = v.y;\n      }\n    });\n  }\n  function scroll(x, y) {\n    cancelZoomAnimation();\n    moveTo(x, y);\n  }\n  function dispose() {\n    releaseEvents();\n  }\n  function listenForEvents() {\n    owner.addEventListener('mousedown', onMouseDown, {\n      passive: false\n    });\n    owner.addEventListener('dblclick', onDoubleClick, {\n      passive: false\n    });\n    owner.addEventListener('touchstart', onTouch, {\n      passive: false\n    });\n    owner.addEventListener('keydown', onKeyDown, {\n      passive: false\n    });\n\n    // Need to listen on the owner container, so that we are not limited\n    // by the size of the scrollable domElement\n    wheel.addWheelListener(owner, onMouseWheel, {\n      passive: false\n    });\n    makeDirty();\n  }\n  function releaseEvents() {\n    wheel.removeWheelListener(owner, onMouseWheel);\n    owner.removeEventListener('mousedown', onMouseDown);\n    owner.removeEventListener('keydown', onKeyDown);\n    owner.removeEventListener('dblclick', onDoubleClick);\n    owner.removeEventListener('touchstart', onTouch);\n    if (frameAnimation) {\n      window.cancelAnimationFrame(frameAnimation);\n      frameAnimation = 0;\n    }\n    smoothScroll.cancel();\n    releaseDocumentMouse();\n    releaseTouches();\n    textSelection.release();\n    triggerPanEnd();\n  }\n  function frame() {\n    if (isDirty) applyTransform();\n  }\n  function applyTransform() {\n    isDirty = false;\n\n    // TODO: Should I allow to cancel this?\n    panController.applyTransform(transform);\n    triggerEvent('transform');\n    frameAnimation = 0;\n  }\n  function onKeyDown(e) {\n    var x = 0,\n      y = 0,\n      z = 0;\n    if (e.keyCode === 38) {\n      y = 1; // up\n    } else if (e.keyCode === 40) {\n      y = -1; // down\n    } else if (e.keyCode === 37) {\n      x = 1; // left\n    } else if (e.keyCode === 39) {\n      x = -1; // right\n    } else if (e.keyCode === 189 || e.keyCode === 109) {\n      // DASH or SUBTRACT\n      z = 1; // `-` -  zoom out\n    } else if (e.keyCode === 187 || e.keyCode === 107) {\n      // EQUAL SIGN or ADD\n      z = -1; // `=` - zoom in (equal sign on US layout is under `+`)\n    }\n\n    if (filterKey(e, x, y, z)) {\n      // They don't want us to handle the key: https://github.com/anvaka/panzoom/issues/45\n      return;\n    }\n    if (x || y) {\n      e.preventDefault();\n      e.stopPropagation();\n      var clientRect = owner.getBoundingClientRect();\n      // movement speed should be the same in both X and Y direction:\n      var offset = Math.min(clientRect.width, clientRect.height);\n      var moveSpeedRatio = 0.05;\n      var dx = offset * moveSpeedRatio * x;\n      var dy = offset * moveSpeedRatio * y;\n\n      // TODO: currently we do not animate this. It could be better to have animation\n      internalMoveBy(dx, dy);\n    }\n    if (z) {\n      var scaleMultiplier = getScaleMultiplier(z * 100);\n      var offset = transformOrigin ? getTransformOriginOffset() : midPoint();\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n    }\n  }\n  function midPoint() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width / 2,\n      y: ownerRect.height / 2\n    };\n  }\n  function onTouch(e) {\n    // let them override the touch behavior\n    beforeTouch(e);\n    clearPendingClickEventTimeout();\n    if (e.touches.length === 1) {\n      return handleSingleFingerTouch(e, e.touches[0]);\n    } else if (e.touches.length === 2) {\n      // handleTouchMove() will care about pinch zoom.\n      pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n      multiTouch = true;\n      startTouchListenerIfNeeded();\n    }\n  }\n  function beforeTouch(e) {\n    // TODO: Need to unify this filtering names. E.g. use `beforeTouch`\n    if (options.onTouch && !options.onTouch(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/12\n      return;\n    }\n    e.stopPropagation();\n    e.preventDefault();\n  }\n  function beforeDoubleClick(e) {\n    clearPendingClickEventTimeout();\n\n    // TODO: Need to unify this filtering names. E.g. use `beforeDoubleClick``\n    if (options.onDoubleClick && !options.onDoubleClick(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/46\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  function handleSingleFingerTouch(e) {\n    lastTouchStartTime = new Date();\n    var touch = e.touches[0];\n    var offset = getOffsetXY(touch);\n    lastSingleFingerOffset = offset;\n    var point = transformToScreen(offset.x, offset.y);\n    mouseX = point.x;\n    mouseY = point.y;\n    clickX = mouseX;\n    clickY = mouseY;\n    smoothScroll.cancel();\n    startTouchListenerIfNeeded();\n  }\n  function startTouchListenerIfNeeded() {\n    if (touchInProgress) {\n      // no need to do anything, as we already listen to events;\n      return;\n    }\n    touchInProgress = true;\n    document.addEventListener('touchmove', handleTouchMove);\n    document.addEventListener('touchend', handleTouchEnd);\n    document.addEventListener('touchcancel', handleTouchEnd);\n  }\n  function handleTouchMove(e) {\n    if (e.touches.length === 1) {\n      e.stopPropagation();\n      var touch = e.touches[0];\n      var offset = getOffsetXY(touch);\n      var point = transformToScreen(offset.x, offset.y);\n      var dx = point.x - mouseX;\n      var dy = point.y - mouseY;\n      if (dx !== 0 && dy !== 0) {\n        triggerPanStart();\n      }\n      mouseX = point.x;\n      mouseY = point.y;\n      internalMoveBy(dx, dy);\n    } else if (e.touches.length === 2) {\n      // it's a zoom, let's find direction\n      multiTouch = true;\n      var t1 = e.touches[0];\n      var t2 = e.touches[1];\n      var currentPinchLength = getPinchZoomLength(t1, t2);\n\n      // since the zoom speed is always based on distance from 1, we need to apply\n      // pinch speed only on that distance from 1:\n      var scaleMultiplier = 1 + (currentPinchLength / pinchZoomLength - 1) * pinchSpeed;\n      var firstTouchPoint = getOffsetXY(t1);\n      var secondTouchPoint = getOffsetXY(t2);\n      mouseX = (firstTouchPoint.x + secondTouchPoint.x) / 2;\n      mouseY = (firstTouchPoint.y + secondTouchPoint.y) / 2;\n      if (transformOrigin) {\n        var offset = getTransformOriginOffset();\n        mouseX = offset.x;\n        mouseY = offset.y;\n      }\n      publicZoomTo(mouseX, mouseY, scaleMultiplier);\n      pinchZoomLength = currentPinchLength;\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n  function clearPendingClickEventTimeout() {\n    if (pendingClickEventTimeout) {\n      clearTimeout(pendingClickEventTimeout);\n      pendingClickEventTimeout = 0;\n    }\n  }\n  function handlePotentialClickEvent(e) {\n    // we could still be in the double tap mode, let's wait until double tap expires,\n    // and then notify:\n    if (!options.onClick) return;\n    clearPendingClickEventTimeout();\n    var dx = mouseX - clickX;\n    var dy = mouseY - clickY;\n    var l = Math.sqrt(dx * dx + dy * dy);\n    if (l > 5) return; // probably they are panning, ignore it\n\n    pendingClickEventTimeout = setTimeout(function () {\n      pendingClickEventTimeout = 0;\n      options.onClick(e);\n    }, doubleTapSpeedInMS);\n  }\n  function handleTouchEnd(e) {\n    clearPendingClickEventTimeout();\n    if (e.touches.length > 0) {\n      var offset = getOffsetXY(e.touches[0]);\n      var point = transformToScreen(offset.x, offset.y);\n      mouseX = point.x;\n      mouseY = point.y;\n    } else {\n      var now = new Date();\n      if (now - lastTouchEndTime < doubleTapSpeedInMS) {\n        // They did a double tap here\n        if (transformOrigin) {\n          var offset = getTransformOriginOffset();\n          smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n        } else {\n          // We want untransformed x/y here.\n          smoothZoom(lastSingleFingerOffset.x, lastSingleFingerOffset.y, zoomDoubleClickSpeed);\n        }\n      } else if (now - lastTouchStartTime < clickEventTimeInMS) {\n        handlePotentialClickEvent(e);\n      }\n      lastTouchEndTime = now;\n      triggerPanEnd();\n      releaseTouches();\n    }\n  }\n  function getPinchZoomLength(finger1, finger2) {\n    var dx = finger1.clientX - finger2.clientX;\n    var dy = finger1.clientY - finger2.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n  function onDoubleClick(e) {\n    beforeDoubleClick(e);\n    var offset = getOffsetXY(e);\n    if (transformOrigin) {\n      // TODO: looks like this is duplicated in the file.\n      // Need to refactor\n      offset = getTransformOriginOffset();\n    }\n    smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n  }\n  function onMouseDown(e) {\n    clearPendingClickEventTimeout();\n\n    // if client does not want to handle this event - just ignore the call\n    if (beforeMouseDown(e)) return;\n    lastMouseDownedEvent = e;\n    lastMouseDownTime = new Date();\n    if (touchInProgress) {\n      // modern browsers will fire mousedown for touch events too\n      // we do not want this: touch is handled separately.\n      e.stopPropagation();\n      return false;\n    }\n    // for IE, left click == 1\n    // for Firefox, left click == 0\n    var isLeftButton = e.button === 1 && window.event !== null || e.button === 0;\n    if (!isLeftButton) return;\n    smoothScroll.cancel();\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    clickX = mouseX = point.x;\n    clickY = mouseY = point.y;\n\n    // We need to listen on document itself, since mouse can go outside of the\n    // window, and we will loose it\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    textSelection.capture(e.target || e.srcElement);\n    return false;\n  }\n  function onMouseMove(e) {\n    // no need to worry about mouse events when touch is happening\n    if (touchInProgress) return;\n    triggerPanStart();\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    var dx = point.x - mouseX;\n    var dy = point.y - mouseY;\n    mouseX = point.x;\n    mouseY = point.y;\n    internalMoveBy(dx, dy);\n  }\n  function onMouseUp() {\n    var now = new Date();\n    if (now - lastMouseDownTime < clickEventTimeInMS) handlePotentialClickEvent(lastMouseDownedEvent);\n    textSelection.release();\n    triggerPanEnd();\n    releaseDocumentMouse();\n  }\n  function releaseDocumentMouse() {\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n    panstartFired = false;\n  }\n  function releaseTouches() {\n    document.removeEventListener('touchmove', handleTouchMove);\n    document.removeEventListener('touchend', handleTouchEnd);\n    document.removeEventListener('touchcancel', handleTouchEnd);\n    panstartFired = false;\n    multiTouch = false;\n    touchInProgress = false;\n  }\n  function onMouseWheel(e) {\n    // if client does not want to handle this event - just ignore the call\n    if (beforeWheel(e)) return;\n    smoothScroll.cancel();\n    var delta = e.deltaY;\n    if (e.deltaMode > 0) delta *= 100;\n    var scaleMultiplier = getScaleMultiplier(delta);\n    if (scaleMultiplier !== 1) {\n      var offset = transformOrigin ? getTransformOriginOffset() : getOffsetXY(e);\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n      e.preventDefault();\n    }\n  }\n  function getOffsetXY(e) {\n    var offsetX, offsetY;\n    // I tried using e.offsetX, but that gives wrong results for svg, when user clicks on a path.\n    var ownerRect = owner.getBoundingClientRect();\n    offsetX = e.clientX - ownerRect.left;\n    offsetY = e.clientY - ownerRect.top;\n    return {\n      x: offsetX,\n      y: offsetY\n    };\n  }\n  function smoothZoom(clientX, clientY, scaleMultiplier) {\n    var fromValue = transform.scale;\n    var from = {\n      scale: fromValue\n    };\n    var to = {\n      scale: scaleMultiplier * fromValue\n    };\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      },\n      done: triggerZoomEnd\n    });\n  }\n  function smoothZoomAbs(clientX, clientY, toScaleValue) {\n    var fromValue = transform.scale;\n    var from = {\n      scale: fromValue\n    };\n    var to = {\n      scale: toScaleValue\n    };\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      }\n    });\n  }\n  function getTransformOriginOffset() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width * transformOrigin.x,\n      y: ownerRect.height * transformOrigin.y\n    };\n  }\n  function publicZoomTo(clientX, clientY, scaleMultiplier) {\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n    return zoomByRatio(clientX, clientY, scaleMultiplier);\n  }\n  function cancelZoomAnimation() {\n    if (zoomToAnimation) {\n      zoomToAnimation.cancel();\n      zoomToAnimation = null;\n    }\n  }\n  function getScaleMultiplier(delta) {\n    var sign = Math.sign(delta);\n    var deltaAdjustedSpeed = Math.min(0.25, Math.abs(speed * delta / 128));\n    return 1 - sign * deltaAdjustedSpeed;\n  }\n  function triggerPanStart() {\n    if (!panstartFired) {\n      triggerEvent('panstart');\n      panstartFired = true;\n      smoothScroll.start();\n    }\n  }\n  function triggerPanEnd() {\n    if (panstartFired) {\n      // we should never run smooth scrolling if it was multiTouch (pinch zoom animation):\n      if (!multiTouch) smoothScroll.stop();\n      triggerEvent('panend');\n    }\n  }\n  function triggerZoomEnd() {\n    triggerEvent('zoomend');\n  }\n  function triggerEvent(name) {\n    api.fire(name, api);\n  }\n}\nfunction parseTransformOrigin(options) {\n  if (!options) return;\n  if (typeof options === 'object') {\n    if (!isNumber(options.x) || !isNumber(options.y)) failTransformOrigin(options);\n    return options;\n  }\n  failTransformOrigin();\n}\nfunction failTransformOrigin(options) {\n  console.error(options);\n  throw new Error(['Cannot parse transform origin.', 'Some good examples:', '  \"center center\" can be achieved with {x: 0.5, y: 0.5}', '  \"top center\" can be achieved with {x: 0.5, y: 0}', '  \"bottom right\" can be achieved with {x: 1, y: 1}'].join('\\n'));\n}\nfunction noop() {}\nfunction validateBounds(bounds) {\n  var boundsType = typeof bounds;\n  if (boundsType === 'undefined' || boundsType === 'boolean') return; // this is okay\n  // otherwise need to be more thorough:\n  var validBounds = isNumber(bounds.left) && isNumber(bounds.top) && isNumber(bounds.bottom) && isNumber(bounds.right);\n  if (!validBounds) throw new Error('Bounds object is not valid. It can be: ' + 'undefined, boolean (true|false) or an object {left, top, right, bottom}');\n}\nfunction isNumber(x) {\n  return Number.isFinite(x);\n}\n\n// IE 11 does not support isNaN:\nfunction isNaN(value) {\n  if (Number.isNaN) {\n    return Number.isNaN(value);\n  }\n  return value !== value;\n}\nfunction rigidScroll() {\n  return {\n    start: noop,\n    stop: noop,\n    cancel: noop\n  };\n}\nfunction autoRun() {\n  if (typeof document === 'undefined') return;\n  var scripts = document.getElementsByTagName('script');\n  if (!scripts) return;\n  var panzoomScript;\n  for (var i = 0; i < scripts.length; ++i) {\n    var x = scripts[i];\n    if (x.src && x.src.match(/\\bpanzoom(\\.min)?\\.js/)) {\n      panzoomScript = x;\n      break;\n    }\n  }\n  if (!panzoomScript) return;\n  var query = panzoomScript.getAttribute('query');\n  if (!query) return;\n  var globalName = panzoomScript.getAttribute('name') || 'pz';\n  var started = Date.now();\n  tryAttach();\n  function tryAttach() {\n    var el = document.querySelector(query);\n    if (!el) {\n      var now = Date.now();\n      var elapsed = now - started;\n      if (elapsed < 2000) {\n        // Let's wait a bit\n        setTimeout(tryAttach, 100);\n        return;\n      }\n      // If we don't attach within 2 seconds to the target element, consider it a failure\n      console.error('Cannot find the panzoom element', globalName);\n      return;\n    }\n    var options = collectOptions(panzoomScript);\n    console.log(options);\n    window[globalName] = createPanZoom(el, options);\n  }\n  function collectOptions(script) {\n    var attrs = script.attributes;\n    var options = {};\n    for (var j = 0; j < attrs.length; ++j) {\n      var attr = attrs[j];\n      var nameValue = getPanzoomAttributeNameValue(attr);\n      if (nameValue) {\n        options[nameValue.name] = nameValue.value;\n      }\n    }\n    return options;\n  }\n  function getPanzoomAttributeNameValue(attr) {\n    if (!attr.name) return;\n    var isPanZoomAttribute = attr.name[0] === 'p' && attr.name[1] === 'z' && attr.name[2] === '-';\n    if (!isPanZoomAttribute) return;\n    var name = attr.name.substr(3);\n    var value = JSON.parse(attr.value);\n    return {\n      name: name,\n      value: value\n    };\n  }\n}\nautoRun();","map":{"version":3,"names":["wheel","require","animate","eventify","kinetic","createTextSelectionInterceptor","domTextSelectionInterceptor","fakeTextSelectorInterceptor","Transform","makeSvgController","makeDomController","defaultZoomSpeed","defaultDoubleTapZoomSpeed","doubleTapSpeedInMS","clickEventTimeInMS","module","exports","createPanZoom","domElement","options","panController","controller","canAttach","Error","owner","getOwner","storedCTMResult","x","y","isDirty","transform","initTransform","filterKey","noop","pinchSpeed","bounds","maxZoom","Number","POSITIVE_INFINITY","minZoom","boundsPadding","zoomDoubleClickSpeed","beforeWheel","beforeMouseDown","speed","zoomSpeed","transformOrigin","parseTransformOrigin","textSelection","enableTextSelection","validateBounds","autocenter","frameAnimation","lastTouchEndTime","lastTouchStartTime","pendingClickEventTimeout","lastMouseDownedEvent","lastMouseDownTime","Date","lastSingleFingerOffset","touchInProgress","panstartFired","mouseX","mouseY","clickX","clickY","pinchZoomLength","smoothScroll","rigidScroll","getPoint","scroll","moveByAnimation","zoomToAnimation","multiTouch","paused","listenForEvents","api","dispose","moveBy","internalMoveBy","moveTo","smoothMoveTo","centerOn","zoomTo","publicZoomTo","zoomAbs","smoothZoom","smoothZoomAbs","showRectangle","pause","resume","isPaused","getTransform","getTransformModel","getMinZoom","setMinZoom","getMaxZoom","setMaxZoom","getTransformOrigin","setTransformOrigin","getZoomSpeed","setZoomSpeed","initialX","initialY","initialZoom","scale","releaseEvents","rect","clientRect","getBoundingClientRect","size","transformToScreen","width","height","rectWidth","right","left","rectHeight","bottom","top","isFinite","dw","dh","Math","min","getScreenCTM","parentCTM","parentScaleX","a","parentScaleY","d","parentOffsetX","e","parentOffsetY","f","w","h","sceneBoundingBox","getBoundingBox","ownerRect","bbox","getBBox","newMinZoom","newMaxZoom","newTransformOrigin","newSpeed","keepTransformInsideBounds","triggerEvent","makeDirty","dx","dy","boundingBox","adjusted","getClientRect","diff","sceneWidth","sceneHeight","leftTop","client","window","requestAnimationFrame","frame","zoomByRatio","clientX","clientY","ratio","isNaN","newScale","transformAdjusted","zoomLevel","ui","parent","ownerSVGElement","cx","cy","container","smooth","cancel","from","to","lastX","lastY","step","v","cancelZoomAnimation","addEventListener","onMouseDown","passive","onDoubleClick","onTouch","onKeyDown","addWheelListener","onMouseWheel","removeWheelListener","removeEventListener","cancelAnimationFrame","releaseDocumentMouse","releaseTouches","release","triggerPanEnd","applyTransform","z","keyCode","preventDefault","stopPropagation","offset","moveSpeedRatio","scaleMultiplier","getScaleMultiplier","getTransformOriginOffset","midPoint","beforeTouch","clearPendingClickEventTimeout","touches","length","handleSingleFingerTouch","getPinchZoomLength","startTouchListenerIfNeeded","beforeDoubleClick","touch","getOffsetXY","point","document","handleTouchMove","handleTouchEnd","triggerPanStart","t1","t2","currentPinchLength","firstTouchPoint","secondTouchPoint","clearTimeout","handlePotentialClickEvent","onClick","l","sqrt","setTimeout","now","finger1","finger2","isLeftButton","button","event","onMouseMove","onMouseUp","capture","target","srcElement","delta","deltaY","deltaMode","offsetX","offsetY","fromValue","done","triggerZoomEnd","toScaleValue","sign","deltaAdjustedSpeed","abs","start","stop","name","fire","isNumber","failTransformOrigin","console","error","join","boundsType","validBounds","value","autoRun","scripts","getElementsByTagName","panzoomScript","i","src","match","query","getAttribute","globalName","started","tryAttach","el","querySelector","elapsed","collectOptions","log","script","attrs","attributes","j","attr","nameValue","getPanzoomAttributeNameValue","isPanZoomAttribute","substr","JSON","parse"],"sources":["/Users/arricodyanto/Dev/react-mapp/node_modules/panzoom/index.js"],"sourcesContent":["'use strict';\n/**\n * Allows to drag and zoom svg elements\n */\nvar wheel = require('wheel');\nvar animate = require('amator');\nvar eventify = require('ngraph.events');\nvar kinetic = require('./lib/kinetic.js');\nvar createTextSelectionInterceptor = require('./lib/createTextSelectionInterceptor.js');\nvar domTextSelectionInterceptor = createTextSelectionInterceptor();\nvar fakeTextSelectorInterceptor = createTextSelectionInterceptor(true);\nvar Transform = require('./lib/transform.js');\nvar makeSvgController = require('./lib/svgController.js');\nvar makeDomController = require('./lib/domController.js');\n\nvar defaultZoomSpeed = 1;\nvar defaultDoubleTapZoomSpeed = 1.75;\nvar doubleTapSpeedInMS = 300;\nvar clickEventTimeInMS = 200;\n\nmodule.exports = createPanZoom;\n\n/**\n * Creates a new instance of panzoom, so that an object can be panned and zoomed\n *\n * @param {DOMElement} domElement where panzoom should be attached.\n * @param {Object} options that configure behavior.\n */\nfunction createPanZoom(domElement, options) {\n  options = options || {};\n\n  var panController = options.controller;\n\n  if (!panController) {\n    if (makeSvgController.canAttach(domElement)) {\n      panController = makeSvgController(domElement, options);\n    } else if (makeDomController.canAttach(domElement)) {\n      panController = makeDomController(domElement, options);\n    }\n  }\n\n  if (!panController) {\n    throw new Error(\n      'Cannot create panzoom for the current type of dom element'\n    );\n  }\n  var owner = panController.getOwner();\n  // just to avoid GC pressure, every time we do intermediate transform\n  // we return this object. For internal use only. Never give it back to the consumer of this library\n  var storedCTMResult = { x: 0, y: 0 };\n\n  var isDirty = false;\n  var transform = new Transform();\n\n  if (panController.initTransform) {\n    panController.initTransform(transform);\n  }\n\n  var filterKey = typeof options.filterKey === 'function' ? options.filterKey : noop;\n  // TODO: likely need to unite pinchSpeed with zoomSpeed\n  var pinchSpeed = typeof options.pinchSpeed === 'number' ? options.pinchSpeed : 1;\n  var bounds = options.bounds;\n  var maxZoom = typeof options.maxZoom === 'number' ? options.maxZoom : Number.POSITIVE_INFINITY;\n  var minZoom = typeof options.minZoom === 'number' ? options.minZoom : 0;\n\n  var boundsPadding = typeof options.boundsPadding === 'number' ? options.boundsPadding : 0.05;\n  var zoomDoubleClickSpeed = typeof options.zoomDoubleClickSpeed === 'number' ? options.zoomDoubleClickSpeed : defaultDoubleTapZoomSpeed;\n  var beforeWheel = options.beforeWheel || noop;\n  var beforeMouseDown = options.beforeMouseDown || noop;\n  var speed = typeof options.zoomSpeed === 'number' ? options.zoomSpeed : defaultZoomSpeed;\n  var transformOrigin = parseTransformOrigin(options.transformOrigin);\n  var textSelection = options.enableTextSelection ? fakeTextSelectorInterceptor : domTextSelectionInterceptor;\n\n  validateBounds(bounds);\n\n  if (options.autocenter) {\n    autocenter();\n  }\n\n  var frameAnimation;\n  var lastTouchEndTime = 0;\n  var lastTouchStartTime = 0;\n  var pendingClickEventTimeout = 0;\n  var lastMouseDownedEvent = null;\n  var lastMouseDownTime = new Date();\n  var lastSingleFingerOffset;\n  var touchInProgress = false;\n\n  // We only need to fire panstart when actual move happens\n  var panstartFired = false;\n\n  // cache mouse coordinates here\n  var mouseX;\n  var mouseY;\n\n  // Where the first click has happened, so that we can differentiate\n  // between pan and click\n  var clickX;\n  var clickY;\n\n  var pinchZoomLength;\n\n  var smoothScroll;\n  if ('smoothScroll' in options && !options.smoothScroll) {\n    // If user explicitly asked us not to use smooth scrolling, we obey\n    smoothScroll = rigidScroll();\n  } else {\n    // otherwise we use forward smoothScroll settings to kinetic API\n    // which makes scroll smoothing.\n    smoothScroll = kinetic(getPoint, scroll, options.smoothScroll);\n  }\n\n  var moveByAnimation;\n  var zoomToAnimation;\n\n  var multiTouch;\n  var paused = false;\n\n  listenForEvents();\n\n  var api = {\n    dispose: dispose,\n    moveBy: internalMoveBy,\n    moveTo: moveTo,\n    smoothMoveTo: smoothMoveTo, \n    centerOn: centerOn,\n    zoomTo: publicZoomTo,\n    zoomAbs: zoomAbs,\n    smoothZoom: smoothZoom,\n    smoothZoomAbs: smoothZoomAbs,\n    showRectangle: showRectangle,\n\n    pause: pause,\n    resume: resume,\n    isPaused: isPaused,\n\n    getTransform: getTransformModel,\n\n    getMinZoom: getMinZoom,\n    setMinZoom: setMinZoom,\n\n    getMaxZoom: getMaxZoom,\n    setMaxZoom: setMaxZoom,\n\n    getTransformOrigin: getTransformOrigin,\n    setTransformOrigin: setTransformOrigin,\n\n    getZoomSpeed: getZoomSpeed,\n    setZoomSpeed: setZoomSpeed\n  };\n\n  eventify(api);\n  \n  var initialX = typeof options.initialX === 'number' ? options.initialX : transform.x;\n  var initialY = typeof options.initialY === 'number' ? options.initialY : transform.y;\n  var initialZoom = typeof options.initialZoom === 'number' ? options.initialZoom : transform.scale;\n\n  if(initialX != transform.x || initialY != transform.y || initialZoom != transform.scale){\n    zoomAbs(initialX, initialY, initialZoom);\n  }\n\n  return api;\n\n  function pause() {\n    releaseEvents();\n    paused = true;\n  }\n\n  function resume() {\n    if (paused) {\n      listenForEvents();\n      paused = false;\n    }\n  }\n\n  function isPaused() {\n    return paused;\n  }\n\n  function showRectangle(rect) {\n    // TODO: this duplicates autocenter. I think autocenter should go.\n    var clientRect = owner.getBoundingClientRect();\n    var size = transformToScreen(clientRect.width, clientRect.height);\n\n    var rectWidth = rect.right - rect.left;\n    var rectHeight = rect.bottom - rect.top;\n    if (!Number.isFinite(rectWidth) || !Number.isFinite(rectHeight)) {\n      throw new Error('Invalid rectangle');\n    }\n\n    var dw = size.x / rectWidth;\n    var dh = size.y / rectHeight;\n    var scale = Math.min(dw, dh);\n    transform.x = -(rect.left + rectWidth / 2) * scale + size.x / 2;\n    transform.y = -(rect.top + rectHeight / 2) * scale + size.y / 2;\n    transform.scale = scale;\n  }\n\n  function transformToScreen(x, y) {\n    if (panController.getScreenCTM) {\n      var parentCTM = panController.getScreenCTM();\n      var parentScaleX = parentCTM.a;\n      var parentScaleY = parentCTM.d;\n      var parentOffsetX = parentCTM.e;\n      var parentOffsetY = parentCTM.f;\n      storedCTMResult.x = x * parentScaleX - parentOffsetX;\n      storedCTMResult.y = y * parentScaleY - parentOffsetY;\n    } else {\n      storedCTMResult.x = x;\n      storedCTMResult.y = y;\n    }\n\n    return storedCTMResult;\n  }\n\n  function autocenter() {\n    var w; // width of the parent\n    var h; // height of the parent\n    var left = 0;\n    var top = 0;\n    var sceneBoundingBox = getBoundingBox();\n    if (sceneBoundingBox) {\n      // If we have bounding box - use it.\n      left = sceneBoundingBox.left;\n      top = sceneBoundingBox.top;\n      w = sceneBoundingBox.right - sceneBoundingBox.left;\n      h = sceneBoundingBox.bottom - sceneBoundingBox.top;\n    } else {\n      // otherwise just use whatever space we have\n      var ownerRect = owner.getBoundingClientRect();\n      w = ownerRect.width;\n      h = ownerRect.height;\n    }\n    var bbox = panController.getBBox();\n    if (bbox.width === 0 || bbox.height === 0) {\n      // we probably do not have any elements in the SVG\n      // just bail out;\n      return;\n    }\n    var dh = h / bbox.height;\n    var dw = w / bbox.width;\n    var scale = Math.min(dw, dh);\n    transform.x = -(bbox.left + bbox.width / 2) * scale + w / 2 + left;\n    transform.y = -(bbox.top + bbox.height / 2) * scale + h / 2 + top;\n    transform.scale = scale;\n  }\n\n  function getTransformModel() {\n    // TODO: should this be read only?\n    return transform;\n  }\n\n  function getMinZoom() {\n    return minZoom;\n  }\n\n  function setMinZoom(newMinZoom) {\n    minZoom = newMinZoom;\n  }\n\n  function getMaxZoom() {\n    return maxZoom;\n  }\n\n  function setMaxZoom(newMaxZoom) {\n    maxZoom = newMaxZoom;\n  }\n\n  function getTransformOrigin() {\n    return transformOrigin;\n  }\n\n  function setTransformOrigin(newTransformOrigin) {\n    transformOrigin = parseTransformOrigin(newTransformOrigin);\n  }\n\n  function getZoomSpeed() {\n    return speed;\n  }\n\n  function setZoomSpeed(newSpeed) {\n    if (!Number.isFinite(newSpeed)) {\n      throw new Error('Zoom speed should be a number');\n    }\n    speed = newSpeed;\n  }\n\n  function getPoint() {\n    return {\n      x: transform.x,\n      y: transform.y\n    };\n  }\n\n  function moveTo(x, y) {\n    transform.x = x;\n    transform.y = y;\n\n    keepTransformInsideBounds();\n\n    triggerEvent('pan');\n    makeDirty();\n  }\n\n  function moveBy(dx, dy) {\n    moveTo(transform.x + dx, transform.y + dy);\n  }\n\n  function keepTransformInsideBounds() {\n    var boundingBox = getBoundingBox();\n    if (!boundingBox) return;\n\n    var adjusted = false;\n    var clientRect = getClientRect();\n\n    var diff = boundingBox.left - clientRect.right;\n    if (diff > 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n    // check the other side:\n    diff = boundingBox.right - clientRect.left;\n    if (diff < 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n\n    // y axis:\n    diff = boundingBox.top - clientRect.bottom;\n    if (diff > 0) {\n      // we adjust transform, so that it matches exactly our bounding box:\n      // transform.y = boundingBox.top - (boundingBox.height + boundingBox.y) * transform.scale =>\n      // transform.y = boundingBox.top - (clientRect.bottom - transform.y) =>\n      // transform.y = diff + transform.y =>\n      transform.y += diff;\n      adjusted = true;\n    }\n\n    diff = boundingBox.bottom - clientRect.top;\n    if (diff < 0) {\n      transform.y += diff;\n      adjusted = true;\n    }\n    return adjusted;\n  }\n\n  /**\n   * Returns bounding box that should be used to restrict scene movement.\n   */\n  function getBoundingBox() {\n    if (!bounds) return; // client does not want to restrict movement\n\n    if (typeof bounds === 'boolean') {\n      // for boolean type we use parent container bounds\n      var ownerRect = owner.getBoundingClientRect();\n      var sceneWidth = ownerRect.width;\n      var sceneHeight = ownerRect.height;\n\n      return {\n        left: sceneWidth * boundsPadding,\n        top: sceneHeight * boundsPadding,\n        right: sceneWidth * (1 - boundsPadding),\n        bottom: sceneHeight * (1 - boundsPadding)\n      };\n    }\n\n    return bounds;\n  }\n\n  function getClientRect() {\n    var bbox = panController.getBBox();\n    var leftTop = client(bbox.left, bbox.top);\n\n    return {\n      left: leftTop.x,\n      top: leftTop.y,\n      right: bbox.width * transform.scale + leftTop.x,\n      bottom: bbox.height * transform.scale + leftTop.y\n    };\n  }\n\n  function client(x, y) {\n    return {\n      x: x * transform.scale + transform.x,\n      y: y * transform.scale + transform.y\n    };\n  }\n\n  function makeDirty() {\n    isDirty = true;\n    frameAnimation = window.requestAnimationFrame(frame);\n  }\n\n  function zoomByRatio(clientX, clientY, ratio) {\n    if (isNaN(clientX) || isNaN(clientY) || isNaN(ratio)) {\n      throw new Error('zoom requires valid numbers');\n    }\n\n    var newScale = transform.scale * ratio;\n\n    if (newScale < minZoom) {\n      if (transform.scale === minZoom) return;\n\n      ratio = minZoom / transform.scale;\n    }\n    if (newScale > maxZoom) {\n      if (transform.scale === maxZoom) return;\n\n      ratio = maxZoom / transform.scale;\n    }\n\n    var size = transformToScreen(clientX, clientY);\n\n    transform.x = size.x - ratio * (size.x - transform.x);\n    transform.y = size.y - ratio * (size.y - transform.y);\n\n    // TODO: https://github.com/anvaka/panzoom/issues/112\n    if (bounds && boundsPadding === 1 && minZoom === 1) {\n      transform.scale *= ratio;\n      keepTransformInsideBounds();\n    } else {\n      var transformAdjusted = keepTransformInsideBounds();\n      if (!transformAdjusted) transform.scale *= ratio;\n    }\n\n    triggerEvent('zoom');\n\n    makeDirty();\n  }\n\n  function zoomAbs(clientX, clientY, zoomLevel) {\n    var ratio = zoomLevel / transform.scale;\n    zoomByRatio(clientX, clientY, ratio);\n  }\n\n  function centerOn(ui) {\n    var parent = ui.ownerSVGElement;\n    if (!parent)\n      throw new Error('ui element is required to be within the scene');\n\n    // TODO: should i use controller's screen CTM?\n    var clientRect = ui.getBoundingClientRect();\n    var cx = clientRect.left + clientRect.width / 2;\n    var cy = clientRect.top + clientRect.height / 2;\n\n    var container = parent.getBoundingClientRect();\n    var dx = container.width / 2 - cx;\n    var dy = container.height / 2 - cy;\n\n    internalMoveBy(dx, dy, true);\n  }\n\n  function smoothMoveTo(x, y){\n    internalMoveBy(x - transform.x, y - transform.y, true);\n  }\n\n  function internalMoveBy(dx, dy, smooth) {\n    if (!smooth) {\n      return moveBy(dx, dy);\n    }\n\n    if (moveByAnimation) moveByAnimation.cancel();\n\n    var from = { x: 0, y: 0 };\n    var to = { x: dx, y: dy };\n    var lastX = 0;\n    var lastY = 0;\n\n    moveByAnimation = animate(from, to, {\n      step: function (v) {\n        moveBy(v.x - lastX, v.y - lastY);\n\n        lastX = v.x;\n        lastY = v.y;\n      }\n    });\n  }\n\n  function scroll(x, y) {\n    cancelZoomAnimation();\n    moveTo(x, y);\n  }\n\n  function dispose() {\n    releaseEvents();\n  }\n\n  function listenForEvents() {\n    owner.addEventListener('mousedown', onMouseDown, { passive: false });\n    owner.addEventListener('dblclick', onDoubleClick, { passive: false });\n    owner.addEventListener('touchstart', onTouch, { passive: false });\n    owner.addEventListener('keydown', onKeyDown, { passive: false });\n\n    // Need to listen on the owner container, so that we are not limited\n    // by the size of the scrollable domElement\n    wheel.addWheelListener(owner, onMouseWheel, { passive: false });\n\n    makeDirty();\n  }\n\n  function releaseEvents() {\n    wheel.removeWheelListener(owner, onMouseWheel);\n    owner.removeEventListener('mousedown', onMouseDown);\n    owner.removeEventListener('keydown', onKeyDown);\n    owner.removeEventListener('dblclick', onDoubleClick);\n    owner.removeEventListener('touchstart', onTouch);\n\n    if (frameAnimation) {\n      window.cancelAnimationFrame(frameAnimation);\n      frameAnimation = 0;\n    }\n\n    smoothScroll.cancel();\n\n    releaseDocumentMouse();\n    releaseTouches();\n    textSelection.release();\n\n    triggerPanEnd();\n  }\n\n  function frame() {\n    if (isDirty) applyTransform();\n  }\n\n  function applyTransform() {\n    isDirty = false;\n\n    // TODO: Should I allow to cancel this?\n    panController.applyTransform(transform);\n\n    triggerEvent('transform');\n    frameAnimation = 0;\n  }\n\n  function onKeyDown(e) {\n    var x = 0,\n      y = 0,\n      z = 0;\n    if (e.keyCode === 38) {\n      y = 1; // up\n    } else if (e.keyCode === 40) {\n      y = -1; // down\n    } else if (e.keyCode === 37) {\n      x = 1; // left\n    } else if (e.keyCode === 39) {\n      x = -1; // right\n    } else if (e.keyCode === 189 || e.keyCode === 109) {\n      // DASH or SUBTRACT\n      z = 1; // `-` -  zoom out\n    } else if (e.keyCode === 187 || e.keyCode === 107) {\n      // EQUAL SIGN or ADD\n      z = -1; // `=` - zoom in (equal sign on US layout is under `+`)\n    }\n\n    if (filterKey(e, x, y, z)) {\n      // They don't want us to handle the key: https://github.com/anvaka/panzoom/issues/45\n      return;\n    }\n\n    if (x || y) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      var clientRect = owner.getBoundingClientRect();\n      // movement speed should be the same in both X and Y direction:\n      var offset = Math.min(clientRect.width, clientRect.height);\n      var moveSpeedRatio = 0.05;\n      var dx = offset * moveSpeedRatio * x;\n      var dy = offset * moveSpeedRatio * y;\n\n      // TODO: currently we do not animate this. It could be better to have animation\n      internalMoveBy(dx, dy);\n    }\n\n    if (z) {\n      var scaleMultiplier = getScaleMultiplier(z * 100);\n      var offset = transformOrigin ? getTransformOriginOffset() : midPoint();\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n    }\n  }\n\n  function midPoint() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width / 2,\n      y: ownerRect.height / 2\n    };\n  }\n\n  function onTouch(e) {\n    // let them override the touch behavior\n    beforeTouch(e);\n    clearPendingClickEventTimeout();\n\n    if (e.touches.length === 1) {\n      return handleSingleFingerTouch(e, e.touches[0]);\n    } else if (e.touches.length === 2) {\n      // handleTouchMove() will care about pinch zoom.\n      pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n      multiTouch = true;\n      startTouchListenerIfNeeded();\n    }\n  }\n\n  function beforeTouch(e) {\n    // TODO: Need to unify this filtering names. E.g. use `beforeTouch`\n    if (options.onTouch && !options.onTouch(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/12\n      return;\n    }\n\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  function beforeDoubleClick(e) {\n    clearPendingClickEventTimeout();\n\n    // TODO: Need to unify this filtering names. E.g. use `beforeDoubleClick``\n    if (options.onDoubleClick && !options.onDoubleClick(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/46\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  function handleSingleFingerTouch(e) {\n    lastTouchStartTime = new Date();\n    var touch = e.touches[0];\n    var offset = getOffsetXY(touch);\n    lastSingleFingerOffset = offset;\n    var point = transformToScreen(offset.x, offset.y);\n    mouseX = point.x;\n    mouseY = point.y;\n    clickX = mouseX;\n    clickY = mouseY;\n\n    smoothScroll.cancel();\n    startTouchListenerIfNeeded();\n  }\n\n  function startTouchListenerIfNeeded() {\n    if (touchInProgress) {\n      // no need to do anything, as we already listen to events;\n      return;\n    }\n\n    touchInProgress = true;\n    document.addEventListener('touchmove', handleTouchMove);\n    document.addEventListener('touchend', handleTouchEnd);\n    document.addEventListener('touchcancel', handleTouchEnd);\n  }\n\n  function handleTouchMove(e) {\n    if (e.touches.length === 1) {\n      e.stopPropagation();\n      var touch = e.touches[0];\n\n      var offset = getOffsetXY(touch);\n      var point = transformToScreen(offset.x, offset.y);\n\n      var dx = point.x - mouseX;\n      var dy = point.y - mouseY;\n\n      if (dx !== 0 && dy !== 0) {\n        triggerPanStart();\n      }\n      mouseX = point.x;\n      mouseY = point.y;\n      internalMoveBy(dx, dy);\n    } else if (e.touches.length === 2) {\n      // it's a zoom, let's find direction\n      multiTouch = true;\n      var t1 = e.touches[0];\n      var t2 = e.touches[1];\n      var currentPinchLength = getPinchZoomLength(t1, t2);\n\n      // since the zoom speed is always based on distance from 1, we need to apply\n      // pinch speed only on that distance from 1:\n      var scaleMultiplier =\n        1 + (currentPinchLength / pinchZoomLength - 1) * pinchSpeed;\n\n      var firstTouchPoint = getOffsetXY(t1);\n      var secondTouchPoint = getOffsetXY(t2);\n      mouseX = (firstTouchPoint.x + secondTouchPoint.x) / 2;\n      mouseY = (firstTouchPoint.y + secondTouchPoint.y) / 2;\n      if (transformOrigin) {\n        var offset = getTransformOriginOffset();\n        mouseX = offset.x;\n        mouseY = offset.y;\n      }\n\n      publicZoomTo(mouseX, mouseY, scaleMultiplier);\n\n      pinchZoomLength = currentPinchLength;\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  function clearPendingClickEventTimeout() {\n    if (pendingClickEventTimeout) {\n      clearTimeout(pendingClickEventTimeout);\n      pendingClickEventTimeout = 0;\n    }\n  }\n\n  function handlePotentialClickEvent(e) {\n    // we could still be in the double tap mode, let's wait until double tap expires,\n    // and then notify:\n    if (!options.onClick) return;\n    clearPendingClickEventTimeout();\n    var dx = mouseX - clickX;\n    var dy = mouseY - clickY;\n    var l = Math.sqrt(dx * dx + dy * dy);\n    if (l > 5) return; // probably they are panning, ignore it\n\n    pendingClickEventTimeout = setTimeout(function() {\n      pendingClickEventTimeout = 0;\n      options.onClick(e);\n    }, doubleTapSpeedInMS);\n  }\n\n  function handleTouchEnd(e) {\n    clearPendingClickEventTimeout();\n    if (e.touches.length > 0) {\n      var offset = getOffsetXY(e.touches[0]);\n      var point = transformToScreen(offset.x, offset.y);\n      mouseX = point.x;\n      mouseY = point.y;\n    } else {\n      var now = new Date();\n      if (now - lastTouchEndTime < doubleTapSpeedInMS) {\n        // They did a double tap here\n        if (transformOrigin) {\n          var offset = getTransformOriginOffset();\n          smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n        } else {\n          // We want untransformed x/y here.\n          smoothZoom(lastSingleFingerOffset.x, lastSingleFingerOffset.y, zoomDoubleClickSpeed);\n        }\n      } else if (now - lastTouchStartTime < clickEventTimeInMS) {\n        handlePotentialClickEvent(e);\n      }\n\n      lastTouchEndTime = now;\n\n      triggerPanEnd();\n      releaseTouches();\n    }\n  }\n\n  function getPinchZoomLength(finger1, finger2) {\n    var dx = finger1.clientX - finger2.clientX;\n    var dy = finger1.clientY - finger2.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  function onDoubleClick(e) {\n    beforeDoubleClick(e);\n    var offset = getOffsetXY(e);\n    if (transformOrigin) {\n      // TODO: looks like this is duplicated in the file.\n      // Need to refactor\n      offset = getTransformOriginOffset();\n    }\n    smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n  }\n\n  function onMouseDown(e) {\n    clearPendingClickEventTimeout();\n\n    // if client does not want to handle this event - just ignore the call\n    if (beforeMouseDown(e)) return;\n\n    lastMouseDownedEvent = e;\n    lastMouseDownTime = new Date();\n\n    if (touchInProgress) {\n      // modern browsers will fire mousedown for touch events too\n      // we do not want this: touch is handled separately.\n      e.stopPropagation();\n      return false;\n    }\n    // for IE, left click == 1\n    // for Firefox, left click == 0\n    var isLeftButton =\n      (e.button === 1 && window.event !== null) || e.button === 0;\n    if (!isLeftButton) return;\n\n    smoothScroll.cancel();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    clickX = mouseX = point.x;\n    clickY = mouseY = point.y;\n\n    // We need to listen on document itself, since mouse can go outside of the\n    // window, and we will loose it\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    textSelection.capture(e.target || e.srcElement);\n\n    return false;\n  }\n\n  function onMouseMove(e) {\n    // no need to worry about mouse events when touch is happening\n    if (touchInProgress) return;\n\n    triggerPanStart();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    var dx = point.x - mouseX;\n    var dy = point.y - mouseY;\n\n    mouseX = point.x;\n    mouseY = point.y;\n\n    internalMoveBy(dx, dy);\n  }\n\n  function onMouseUp() {\n    var now = new Date();\n    if (now - lastMouseDownTime < clickEventTimeInMS) handlePotentialClickEvent(lastMouseDownedEvent);\n    textSelection.release();\n    triggerPanEnd();\n    releaseDocumentMouse();\n  }\n\n  function releaseDocumentMouse() {\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n    panstartFired = false;\n  }\n\n  function releaseTouches() {\n    document.removeEventListener('touchmove', handleTouchMove);\n    document.removeEventListener('touchend', handleTouchEnd);\n    document.removeEventListener('touchcancel', handleTouchEnd);\n    panstartFired = false;\n    multiTouch = false;\n    touchInProgress = false;\n  }\n\n  function onMouseWheel(e) {\n    // if client does not want to handle this event - just ignore the call\n    if (beforeWheel(e)) return;\n\n    smoothScroll.cancel();\n\n    var delta = e.deltaY;\n    if (e.deltaMode > 0) delta *= 100;\n\n    var scaleMultiplier = getScaleMultiplier(delta);\n\n    if (scaleMultiplier !== 1) {\n      var offset = transformOrigin\n        ? getTransformOriginOffset()\n        : getOffsetXY(e);\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n      e.preventDefault();\n    }\n  }\n\n  function getOffsetXY(e) {\n    var offsetX, offsetY;\n    // I tried using e.offsetX, but that gives wrong results for svg, when user clicks on a path.\n    var ownerRect = owner.getBoundingClientRect();\n    offsetX = e.clientX - ownerRect.left;\n    offsetY = e.clientY - ownerRect.top;\n\n    return { x: offsetX, y: offsetY };\n  }\n\n  function smoothZoom(clientX, clientY, scaleMultiplier) {\n    var fromValue = transform.scale;\n    var from = { scale: fromValue };\n    var to = { scale: scaleMultiplier * fromValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      },\n      done: triggerZoomEnd\n    });\n  }\n\n  function smoothZoomAbs(clientX, clientY, toScaleValue) {\n    var fromValue = transform.scale;\n    var from = { scale: fromValue };\n    var to = { scale: toScaleValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      }\n    });\n  }\n\n  function getTransformOriginOffset() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width * transformOrigin.x,\n      y: ownerRect.height * transformOrigin.y\n    };\n  }\n\n  function publicZoomTo(clientX, clientY, scaleMultiplier) {\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n    return zoomByRatio(clientX, clientY, scaleMultiplier);\n  }\n\n  function cancelZoomAnimation() {\n    if (zoomToAnimation) {\n      zoomToAnimation.cancel();\n      zoomToAnimation = null;\n    }\n  }\n\n  function getScaleMultiplier(delta) {\n    var sign = Math.sign(delta);\n    var deltaAdjustedSpeed = Math.min(0.25, Math.abs(speed * delta / 128));\n    return 1 - sign * deltaAdjustedSpeed;\n  }\n\n  function triggerPanStart() {\n    if (!panstartFired) {\n      triggerEvent('panstart');\n      panstartFired = true;\n      smoothScroll.start();\n    }\n  }\n\n  function triggerPanEnd() {\n    if (panstartFired) {\n      // we should never run smooth scrolling if it was multiTouch (pinch zoom animation):\n      if (!multiTouch) smoothScroll.stop();\n      triggerEvent('panend');\n    }\n  }\n\n  function triggerZoomEnd() {\n    triggerEvent('zoomend');\n  }\n\n  function triggerEvent(name) {\n    api.fire(name, api);\n  }\n}\n\nfunction parseTransformOrigin(options) {\n  if (!options) return;\n  if (typeof options === 'object') {\n    if (!isNumber(options.x) || !isNumber(options.y))\n      failTransformOrigin(options);\n    return options;\n  }\n\n  failTransformOrigin();\n}\n\nfunction failTransformOrigin(options) {\n  console.error(options);\n  throw new Error(\n    [\n      'Cannot parse transform origin.',\n      'Some good examples:',\n      '  \"center center\" can be achieved with {x: 0.5, y: 0.5}',\n      '  \"top center\" can be achieved with {x: 0.5, y: 0}',\n      '  \"bottom right\" can be achieved with {x: 1, y: 1}'\n    ].join('\\n')\n  );\n}\n\nfunction noop() { }\n\nfunction validateBounds(bounds) {\n  var boundsType = typeof bounds;\n  if (boundsType === 'undefined' || boundsType === 'boolean') return; // this is okay\n  // otherwise need to be more thorough:\n  var validBounds =\n    isNumber(bounds.left) &&\n    isNumber(bounds.top) &&\n    isNumber(bounds.bottom) &&\n    isNumber(bounds.right);\n\n  if (!validBounds)\n    throw new Error(\n      'Bounds object is not valid. It can be: ' +\n      'undefined, boolean (true|false) or an object {left, top, right, bottom}'\n    );\n}\n\nfunction isNumber(x) {\n  return Number.isFinite(x);\n}\n\n// IE 11 does not support isNaN:\nfunction isNaN(value) {\n  if (Number.isNaN) {\n    return Number.isNaN(value);\n  }\n\n  return value !== value;\n}\n\nfunction rigidScroll() {\n  return {\n    start: noop,\n    stop: noop,\n    cancel: noop\n  };\n}\n\nfunction autoRun() {\n  if (typeof document === 'undefined') return;\n\n  var scripts = document.getElementsByTagName('script');\n  if (!scripts) return;\n  var panzoomScript;\n\n  for (var i = 0; i < scripts.length; ++i) {\n    var x = scripts[i];\n    if (x.src && x.src.match(/\\bpanzoom(\\.min)?\\.js/)) {\n      panzoomScript = x;\n      break;\n    }\n  }\n\n  if (!panzoomScript) return;\n\n  var query = panzoomScript.getAttribute('query');\n  if (!query) return;\n\n  var globalName = panzoomScript.getAttribute('name') || 'pz';\n  var started = Date.now();\n\n  tryAttach();\n\n  function tryAttach() {\n    var el = document.querySelector(query);\n    if (!el) {\n      var now = Date.now();\n      var elapsed = now - started;\n      if (elapsed < 2000) {\n        // Let's wait a bit\n        setTimeout(tryAttach, 100);\n        return;\n      }\n      // If we don't attach within 2 seconds to the target element, consider it a failure\n      console.error('Cannot find the panzoom element', globalName);\n      return;\n    }\n    var options = collectOptions(panzoomScript);\n    console.log(options);\n    window[globalName] = createPanZoom(el, options);\n  }\n\n  function collectOptions(script) {\n    var attrs = script.attributes;\n    var options = {};\n    for (var j = 0; j < attrs.length; ++j) {\n      var attr = attrs[j];\n      var nameValue = getPanzoomAttributeNameValue(attr);\n      if (nameValue) {\n        options[nameValue.name] = nameValue.value;\n      }\n    }\n\n    return options;\n  }\n\n  function getPanzoomAttributeNameValue(attr) {\n    if (!attr.name) return;\n    var isPanZoomAttribute =\n      attr.name[0] === 'p' && attr.name[1] === 'z' && attr.name[2] === '-';\n\n    if (!isPanZoomAttribute) return;\n\n    var name = attr.name.substr(3);\n    var value = JSON.parse(attr.value);\n    return { name: name, value: value };\n  }\n}\n\nautoRun();\n\t"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}